<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
    <title>Alcohol Event Planning app</title>
  </head>
  <body>
    <h1>Hello World</h1>
    <button id="lcbo-data">Get me Data</button>
    <script src="https://code.jquery.com/jquery.js"></script>
    <script>
        $("#lcbo-data").on("click", function(){
    console.log("button works");

    var url = "http://lcboapi.com/products?page=2&access_key=";

    var api_key = "MDplMTI2NmVjYS1iZmYyLTExZTctOGU0NC04MzNjNzk5NzRlMzk6SnRYZWRMTzRENnh4SlJHbjVPWGhWZ1RNU1JIQUNlVUY2bVlS"
    
    var queryURL = url + api_key;

    console.log(queryURL);

      $.ajax({
      url: queryURL,
      method: 'GET'
    }).done(function(response) {

      var lcboObj = response.result;

      var arrayOfLcboResults = [];

      for (var i = 0; i < lcboObj.length; i++) {
        var obj = {
          "type":lcboObj[i].primary_category,
          "name":lcboObj[i].name,
          "image":lcboObj[i].image_thumb_url
        };
        arrayOfLcboResults.push(obj);
      }
      postLcboData(arrayOfLcboResults);
    });// end of AJAX
    
  }); // end of on #lcbo-dat on click listener

  function postLcboData(lcboData){
    console.log("in function");
    console.log(lcboData);

    var lcboObj = {"data": lcboData}

    $.ajax("/api/lcbo", {
      type: "POST",
      data: lcboData
    }).then(function(){
      console.log("response hit");
    });
  }
    </script>
  </body>
</html>
